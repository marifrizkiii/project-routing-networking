<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>FCC Technical Documentation</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <nav id="navbar">
      <header>My Documents Installation Project</header>
      <a href="#Firewal" class="nav-link">Firewal</a>
      <a href="#Installation_Snort" class="nav-link">Installation Snort</a>
      <a href="#Installation_Snowl_Snort_GUI" class="nav-link">Installation Snowl-Snort GUI</a>
      <a href="#Installation_Rkhunter" class="nav-link">Installation Rkhunter</a>
      <a href="#Installation_Nagios" class="nav-link">Installation NaGIOS</a>
      <a href="#Open_VPN_IPv4" class="nav-link">Open VPN IPv4</a>
    </nav>
    <main id="main-doc">
      <section class="main-section" id="Firewal">
        <header>What Is a Firewall?</header>
        <p>
          A firewall is a network security device that monitors incoming and outgoing network traffic and decides whether to allow or block specific traffic based on a defined set of security rules. Firewalls have been a first line of
          defense in network security for over 25 years. They establish a barrier between secured and controlled internal networks that can be trusted and untrusted outside networks, such as the Internet. A firewall can be hardware,
          software, or both.
        </p>
      </section>

      <section class="main-section" id="Installation_Snort">
        <header>IDS and IPS</header>
        <p>
          What is Snort? Snort is the foremost Open Source Intrusion Prevention System (IPS) in the world. Snort IPS uses a series of rules that help define malicious network activity and uses those rules to find packets that match against
          them and generates alerts for users. Snort can be deployed inline to stop these packets, as well. Snort has three primary uses: As a packet sniffer like tcpdump, as a packet logger — which is useful for network traffic debugging,
          or it can be used as a full-blown network intrusion prevention system. Snort can be downloaded and configured for personal and business use alike.
        </p>

        <p>
          What are my options for buying and using Snort? Once downloaded and configured, Snort rules are distributed in two sets: The “Community Ruleset” and the “Snort Subscriber Ruleset.” The Snort Subscriber Ruleset is developed,
          tested, and approved by Cisco Talos. Subscribers to the Snort Subscriber Ruleset will receive the ruleset in real-time as they are released to Cisco customers. You can download the rules and deploy them in your network through the
          Snort.org website. The Community Ruleset is developed by the Snort community and QAed by Cisco Talos. It is freely available to all users.
        </p>

        <p>For more information about Snort Subscriber Rulesets available for purchase, please visit the Snort product page.</p>
        <header>Install Snort Dan Cara Menulis Rules</header>
        <p>Find the appropriate package for your operating system and install.</p>
        <p>Siapkan Aplikasi Pendukung.</p>
        <code>
          <pre>
root@server-IDS-IPS:~# sudo locale-gen id_ID.UTF-8
root@server-IDS-IPS:~# sudo apt-get update</pre
          >
        </code>

        <p>ifconfig dulu cek interface dan IP nya, Lalu Install</p>
        <code>
          <pre>root@server-IDS-IPS:~# apt-get install oinkmaster snort snort-common snort-rules-default snort-doc</pre>
        </code>

        <p>Akan Di Tanya interface yang akan di monitor, misalnya: enp0s3 range IP yang di monitor, misalnya: 192.168.100.0/24</p>

        <p>Cek Snort</p>
        <code>
          <pre> root@server-IDS-IPS:~# snort -C </pre>
        </code>

        <p>Jalankan Snort mode NIDS</p>
        <code>
          <pre> root@server-IDS-IPS:~# snort -dev -l /var/log/snort/ -h 192.168.0.0/24 -c /etc/snort/snort.conf &</pre>
        </code>

        <p>Ingin supaya bisa di baca di kemudian hari oleh wireshark harus di simpan dalam bentuk binary, dengan perintah</p>
        <code>
          <pre>/usr/sbin/snort -m 027 -b -l /var/log/snort/ -u arif -c /etc/snort/snort.conf -S HOME_NET=[192.168.100.0/24] -i wlp2s0 &</pre>
        </code>

        <p>Biar tidak rewel, sebaiknya permission /var/log/snort di jadikan</p>
        <code>
          <pre>chmod 770 /var/log/snort</pre>
        </code>
        <p>Ini sebetulnya cara yang tidak baik!!! PAKE YANG BAWAH AJA BUAT JALANKAN SNORT NYA</p>
        <p>Menjalankan Snort mode NIDS, log text</p>
        <p>log /var/log/snort bisa di baca oleh manusia, kita bisa menjalankan snort dengan perintah,</p>
        <code>
          <pre>root@server-IDS-IPS:~# snort -c /etc/snort/snort.conf -l /var/log/snort/ -K ascii -D</pre>
        </code>
        <p>Check Snort</p>
        <code>
          <pre>root@server:/home/arif# ps ax | grep snort</pre>
        </code>

        <p>Kalo Kill Snort</p>
        <code>
          <pre>
root@server:/var/log/snort# killall snort
root@server:/var/log/snort# ps ax | grep snort
7444 pts/0    S+     0:00 grep --color=auto snort</pre
          >
        </code>

        <p>Check</p>
        <code>
          <pre>
root@server:/etc/snort# vi snort.conf  
root@server:/etc/snort# vi classification.config</pre
          >
        </code>

        <p>KALO 1 ARTI NYA WARNA MERAH BAGUS</p>
        <p>KALO 2 ARTI NYA KUNING WARNING</p>
        <p>KALO 3 ARTINYA IJO BAHAYA</p>
        <code>
          <pre>classification: trojan-activity,A Network Trojan was detected, 1</pre>
          <pre>
root@server:/etc/snort# cd rules/
root@server:/etc/snort/rules# more community-oracle.rules</pre
          >
        </code>

        <p>Yang Penting Kata-Kata content:</p>
        <p>Menjalankan Snort mode NIDS, log text</p>
        <p>Agar log /var/log/snort bisa di baca oleh manusia, kita bisa menjalankan snort dengan perintah,</p>
        <code>
          <pre>
root@server:/var/log/snort# snort -c /etc/snort/snort.conf -l /var/log/snort/ -K ascii -D
root@server:/var/log/snort# watch -n 3 tail /var/log/snort/alert</pre
          >
        </code>

        <p>Sebagai Contoh Kalo Kita Scan Nmap AKAN keluar</p>
        <p>nmap -v -sS -O 192.168.100.21</p>
        <code>
          <pre>
      [**] [1:1228:7] SCAN nmap XMAS [**]
      [Classification: Attempted Information Leak] [Priority: 2]
      09/25-17:36:04.058342 192.168.100.122:63434 -> 192.168.100.21:1
      TCP TTL:55 TOS:0x0 ID:16877 IpLen:20 DgmLen:60</pre
          >
        </code>

        <p>Kalo Untuk Buat Snort Rules Harus Ngerti Regex</p>
        <p>Kalo Mau Nyadap Paket Yang Lewat Dan Kita Kasih REGEX Supaya Kita Extrak Ini Mahkluk Apa Si Kira-Kira Ke Gitu Nyadap Seperti Kayak WIRESHARK Kalo Ini Nyadap Versi CLI TCPDUMP</p>
        <code>
          <pre>root@server:/var/log/snort# snort -C</pre>
        </code>

        <p>Membuat Rules Sederhana</p>
        <code>
          <pre>
root@server:/var/log/snort# cd /etc/snort/rules/
root@server:/etc/snort/rules# vi local.rules</pre
          >
        </code>

        <p>Seperti Ini Tuliskan Dan Save</p>
        <code>
          <pre>alert tcp any any -> 192.168.100.21 22 (msg: "Ada Yang Connect SSH Ke Mesin!!"; sid:1000001;)</pre>
        </code>

        <p>Kill Dulu</p>
        <code>
          <pre>root@server:/etc/snort/rules# killall snort</pre>
        </code>

        <p>Kita remove dulu biar bersih log nya</p>
        <code>
          <pre>
root@server:/etc/snort/rules# cd /var/log/snort/
root@server:/var/log/snort# rm -Rf *</pre
          >
        </code>

        <p>Jalan Kan Lagi</p>
        <code>
          <pre>root@server:/etc/snort/rules# snort -c /etc/snort/snort.conf -l /var/log/snort/ -K ascii -D</pre>
        </code>

        <p>Cek Pake Ps Ax (Liat Software Jalan Di Belakang Layar) Dan Pakai wacth</p>
        <code>
          <pre>
root@server:/etc/snort/rules# ps ax
root@server:/var/log/snort# watch -n 3 tail /var/log/snort/alert</pre
          >
        </code>

        <p>Kita Coba SSH Ke Server</p>

        <p>Akan Keluar</p>
        <code>
          <pre>
      [**] [1:1000001:0] Ada Yang Connect SSH Ke Mesin!! [**]
      [Priority: 0]
      09/25-18:32:00.622198 192.168.100.79:51814 -> 192.168.100.21:3000</pre
          >
        </code>

        <p>Bisa Cek Ke</p>
        <code>
          <pre>root@server:/var/log/snort# vi alert</pre>
        </code>
      </section>

      <section class="main-section" id="Installation_Snowl_Snort_GUI">
        <header>Snowl - Snort Gui</header>
        <p>
          What is Snowl? Snowl is a modern web-based GUI (graphical user interface) for snort. Snort is an open source IDS/IPS (intrusion detection/prevention system). It is command-line tool and has not own graphical interface. Therefore,
          we decided to create Snowl so that the snort setting became automatic and understandable, and the analysis of threats was as convenient as possible.
        </p>
        <header>Instalation</header>
        <p>Please choose your operating system to view the installation guide i use ubuntu.</p>
        <code>
          <pre>
    Biasa Nya Saya Simpan Hasil Download Nya Disini
            root@server-IDS-IPS:/var/log/snort# cd /usr/local/src/
            root@server-IDS-IPS:/usr/local/src# wget https://snowl.io/download/snowl-install-ubuntu.sh
            root@server-IDS-IPS:/usr/local/src# ls
            snowl-install-ubuntu.sh
            root@server-IDS-IPS:/usr/local/src# chmod 755 snowl-install-ubuntu.sh
            root@server-IDS-IPS:/usr/local/src# ./snowl-install-ubuntu.sh

    KETIK yes
            Install Snowl? (yes/no, default yes): yes
    AKAN DI TANYA LAGI KETIK yes
            CEK DI WEB BROWSER
            192.168.100.216:5500
    LOGIN USERNAME & PASSWORD NYA
            admin
            123456
    UBAH PASSWORD NYA BIAR AMAN !!!

    CEK SNOWL
            root@server-IDS-IPS:/usr/local/src# ps -ef | grep snowl
            root@server-IDS-IPS:/usr/local/src# netstat -ntpl | grep 5500

    CARA MENAMBAHKAN RULE
    INI TERGANTUNG SERVER NYA, SERVER NYA ADA APLIKASI APA SAJA
    AGA BERAT INI TERGANTUNG SPEK SERVER NYA
    1. BUKA DI BROWSER 192.168.100.216:5500
    2. PILIH THREAT POLICIES
    3. Add new policy
    4. UNTUK Rule urls KLIK DI BAWAHNYA ADA Examples; ADA 2 Rules, COPY SAJA YANG SATU ADA oinkcode= 
    HARUS LOGIN DULU DI WEBSITE SNORT NYA UNTUK MELIHAT ID NYA INI BISA PAKE BAWAAN Snort ATAU DOWNLOAD 
    Rules Snort DI SINI https://www.snort.org/downloads PAKE YANG Rules Community KARENA GRATIS, 
    SAMA SAJA SEPERTI BAWAAN NYA SEBELUM DOWNLOAD RULE NYA, CEK VERSION SNORT NYA DULU CARA NYA 
    KALO VERSION NYA 2.9.16 PAKE RULE NYA V2.9 KALO VERISON NYA 3.0 PAKE V3.0
            root@server-IDS-IPS:/var/log/snort# snort --version

    COPY SAJA DIBAGIAN Snort v2.9
    KETIKAN SEPERTI DI BAWAH
    Name              : PolicySatu
    Description       : Policy Satu untuk keamanan VLAN intarnet
    Rule urls         : https://www.snort.org/downloads/community/community-rules.tar.gz
                        https://rules.emergingthreats.net/open-nogpl/snort-2.9.0/emerging.rules.tar.gz
    IP blacklist urls : https://talosintelligence.com/documents/ip-blacklist
    SAVE
    ITU SAJA YANG DI TAMBAHKAN PILIH (SAVE)

    SNOWL INSTALLATION
    Server web diperlukan untuk pengoperasian Snowl. Itu bisa Apache atau Nginx.
    Pilih dan instal salah satunya, misalnya Apache.

    PILIH SALAH SATU PENGEN PAKE APA apache2 ATAU PAKE nginx
    Apache installation
            root@server-IDS-IPS:/home/arif#sudo apt install apache2

    Nginx installation
            root@server-IDS-IPS:/home/arif#sudo apt install nginx

    Jalankan perintah berikut untuk menginstal Snowl:
            wget https://snowl.io/download/snowl_1.7.2_amd64.deb && dpkg -i ./snowl_1.7.2_amd64.deb

    Konfigurasikan server web untuk bekerja dengan Snowl. Untuk tujuan ini, lakukan hal berikut:
            /opt/snowl/snowl-configure-httpd

    UNTUK MENGHAPUS SNOWL CEK DULU
            root@server-IDS-IPS:/home/arif# dpkg -l | grep snowl
            ii  snowl-sensor           1.7.2            amd64        Intrusion Detection System SNOWL

    STOP DULU
            root@server-IDS-IPS:/home/arif# service snowl-sensor stop
            root@server-IDS-IPS:/home/arif# service snowl stop

    HAPUS SNOWL
            root@server-IDS-IPS:/home/arif# dpkg -r snowl
            root@server-IDS-IPS:/home/arif# dpkg -r snowl-sensor
            
    CEK
            root@server-IDS-IPS:/home/arif# dpkg -l | grep snort
            
    STOP DULU
            root@server-IDS-IPS:/home/arif# service snowl stop
            
    MENGHAPUS SNORT
            root@server-IDS-IPS:/home/arif# apt-get remove snort*
            root@server-IDS-IPS:/home/arif# apt-get remove --purge snort*
            </pre
          >
        </code>
      </section>

      <section class="main-sections" id="Installation_Rkhunter">
        <header>Rkhunter</header>
        <p>
          One potential concern is rootkits. Rootkits are software secretly installed by malicious intruders that allow those users to resume access to servers after security is breached. This is a very dangerous problem, because even after
          the vector entry that the user originally used to gain permanent access, they can continue to log into the server using the rootkit they installed. One tool that can help you protect your system from problems like this is
          rkhunter. This software checks your system against a database of known rootkits. Also, it can check other system files to make sure they match the expected properties and values.
        </p>
        <header>Install RKHunter Dan Cara Menggunakan</header>
        <p>Please choose your operating system to view the installation guide i use ubuntu.</p>

        <p>Compile RKHunter</p>
        <p>INSTALL APLIKASI PENDUKUNG</p>
        <code>
          <pre>
root@server-IDS-IPS:/usr/local/src# sudo locale-gen id_ID.UTF-8
root@server-IDS-IPS:/usr/local/src# sudo apt-get update
root@server-IDS-IPS:/usr/local/src# sudo apt-get -y install binutils libreadline5 libruby ruby ssl-cert unhide.rb mailutils</pre
          >
        </code>

        <p>MASUKAN</p>
        <code>
          <pre>
- Site localhost
- Relay Site kalau pakai INDIHOME : smtp.telkom.net</pre
          >
        </code>

        <p>Sebelum Download Check Versi Terakhir</p>
        <code>
          <pre>
cd /usr/local/src/
root@server-IDS-IPS:/usr/local/src# wget http://downloads.sourceforge.net/project/rkhunter/rkhunter/1.4.6/rkhunter-1.4.6.tar.gz
root@server-IDS-IPS:/usr/local/src# tar xzvf rkhunter-1.4.6.tar.gz*
root@server-IDS-IPS:/usr/local/src# cd rkhunter-1.4.6*</pre
          >
        </code>

        <p>Install Di /usr</p>
        <code>
          <pre>
root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# ./installer.sh --layout /usr --install
root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# rkhunter --versioncheck</pre
          >
        </code>

        <p>OUTPUT</p>
        <code>
          <pre>
[ Rootkit Hunter version 1.4.6 ]
Checking rkhunter version...
This version  : 1.4.6
Latest version: 1.4.6</pre
          >
        </code>

        <p>UPDATE DATA FILE</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# rkhunter --update</pre>
        </code>

        <p>Set properties update / baseline</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# rkhunter --propupd</pre>
        </code>
        <p>OUTPUT</p>
        <code>
          <pre>
[ Rootkit Hunter version 1.4.6 ]
File created: searched for 180 files, found 139</pre
          >
        </code>

        <p>Jalankan</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# rkhunter -c --enable all --disable none</pre>
        </code>
        <p>Dia akan menjalan test per section.</p>
        <p>Log bisa di lihat di</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# nano /var/log/rkhunter.log</pre>
        </code>

        <p>Atau Pake Ini</p>
        <code>
          <pre>
root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# cat /var/log/rkhunter.log | grep warning
[21:18:08] Info: No mail-on-warning address configured</pre
          >
        </code>
        <p>Alternative lain, perintahkan rkhunter untuk print warning ke layar</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# rkhunter -c --enable all --disable none --rwo</pre>
        </code>
        <p>Tuning Konfigurasi RKHunter supaya lebih baik</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# vi /etc/rkhunter.conf</pre>
        </code>

        <p>Notifikasi email</p>
        <code>
          <pre>
MAIL-ON-WARNING="your_user@domain.com"
MAIL_CMD=mail -s "[rkhunter] Warnings found for ${HOST_NAME}"</pre
          >
        </code>

        <p>Atau</p>
        <code>
          <pre>
MAIL-ON-WARNING="root@localhost"
MAIL_CMD=mail -s "[rkhunter] Warnings found for ${HOST_NAME}"</pre
          >
        </code>

        <p>Ijinkan Root Ssh Login, CONTOH</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# ALLOW_SSH_ROOT_USER=without-password</pre>
        </code>

        <p>Check</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# rkhunter -C</pre>
        </code>
        <p>TEST LAGI APAKAH ADA WARNING</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# rkhunter -c --enable all --disable none --rwo</pre>
        </code>
        <p>Harusnya ada minimal 1 warning, karena konfigurasi rkhunter sudah di ubah,</p>

        <p>Update profile rkhunter</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# rkhunter --propupd</pre>
        </code>
        <p>Cek email untuk notifkasi dari rkhunter</p>

        <p>Cron</p>
        <code>
          <pre>root@server-IDS-IPS:/usr/local/src/rkhunter-1.4.6# crontab -e</pre>
        </code>
        <p>KALAU TIDAK ADA MASALAH, MAKA TIDAK ADA EMAIL YANG AKAN DIKIRIM</p>
      </section>

      <section class="main-section" id="Installation_Nagios">
        <header>NaGIOS</header>
        <p>
          Nagios is a popular open-source monitoring system. Nagios maintains an inventory of your servers and monitors them so you know your critical services are up and running. Using a monitoring system like Nagios is an essential tool
          for any production environment, because by monitoring uptime, CPU usage, or disk space, you can prevent problems before they occur, or before your users contact you. Here we will install Nagios 4 and configure it so that we can
          monitor host resources on the Nagios web interface. We will also setup the Nagios Remote Plugin Executor (NRPE), which will run as the remote host agent so that we can monitor its resources.
        </p>

        <header>Need</header>
        <ul>
          <li>Two Ubuntu 20.04 servers with root user privige. Firewall with ufw.</li>
          <li>Servers with Nagios will be called Nagios servers.</li>
          <li>Servers without Nagios will be called Ubuntu servers.</li>
          <li>Nagios Server will run Apache and PHP.</li>
          <li>Nagios Server is usually run behind a Firewall or VPN. If you run it on a Public IP, you have to be more serious about installing TLS/SSL etc. This tutorial assumes, Nagios server is behind Firewall.</li>
        </ul>
        <header>Installation Nagios 4 dan Memantau Server di Ubuntu 20.04</header>
        <p>Dua VPCS Ubuntu 20.04 satu untuk server Nagios dan satu untuk klien Nagios.</p>
        <p>Akses ke akun pengguna root (atau akses ke akun admin dengan hak akses root.</p>
        <p>Biasa Nya Saya Sebelum Install NaGIOS Ubah Nama Server Dulu Menjadi server-nagios lalu reboot server nya</p>
        <code>
          <pre>
arif@server-ubuntu:~$ sudo vim /etc/hostname 
server-nagios</pre
          >
        </code>
        <p>Langkah 1: Masuk ke Server & Perbarui Paket OS Server</p>
        <code>
          <pre>arif@server-nagios:~$ sudo apt-get update</pre>
        </code>
        <p>Langkah 2: Instal Dependensi yang Diperlukan</p>
        <p>Sebelum memulai, Kita perlu menginstal beberapa dependensi yang diperlukan untuk menginstal Nagios di sistem Anda. Anda dapat menginstal semuanya dengan perintah berikut:</p>
        <code>
          <pre>
arif@server-nagios:~$ sudo apt-get install autoconf bc gawk dc build-essential gcc libc6 make wget unzip apache2 php 
libapache2-mod-php libgd-dev libmcrypt-dev make libssl-dev snmp libnet-snmp-perl gettext -y</pre
          >
        </code>
        <p>Setelah semua dependensi diinstal, Anda dapat melanjutkan untuk mengunduh inti Nagios 4.</p>
        <p>Langkah 3: Unduh dan Instal Nagios 4</p>
        <p>Pertama, unduh versi terbaru Nagios 4 dari situs resminya menggunakan perintah berikut:</p>
        <code>
          <pre>
arif@server-nagios:~$ wget https://assets.nagios.com/downloads/nagioscore/releases/nagios-4.4.6.tar.gz
arif@server-nagios:~$ ls
nagios-4.4.6.tar.gz</pre
          >
        </code>
        <p>Setelah unduhan selesai, ekstrak file yang diunduh dengan perintah berikut:</p>
        <code>
          <pre>arif@server-nagios:~$ tar -xvzf nagios-4.4.6.tar.gz </pre>
        </code>
        <p>Selanjutnya, ubah direktori ke direktori yang diekstraksi dan konfigurasikan dengan perintah berikut:</p>
        <code>
          <pre>
arif@server-nagios:~$ cd nagios-4.4.6/
arif@server-nagios:~/nagios-4.4.6$ ./configure --with-httpd-conf=/etc/apache2/sites-enabled</pre
          >
        </code>
        <p>Kita harus mendapatkan output berikut:</p>
        <code>
          <pre>
*** Configuration summary for nagios 4.4.6 2020-04-28 ***:

General Options:
-------------------------
        Nagios executable:  nagios
        Nagios user/group:  nagios,nagios
      Command user/group:  nagios,nagios
            Event Broker:  yes
        Install ${prefix}:  /usr/local/nagios
    Install ${includedir}:  /usr/local/nagios/include/nagios
                Lock file:  /run/nagios.lock
  Check result directory:  /usr/local/nagios/var/spool/checkresults
          Init directory:  /lib/systemd/system
  Apache conf.d directory:  /etc/apache2/sites-enabled
            Mail program:  /bin/mail
                  Host OS:  linux-gnu
          IOBroker Method:  epoll

Web Interface Options:
------------------------
                HTML URL:  http://localhost/nagios/
                  CGI URL:  http://localhost/nagios/cgi-bin/
Traceroute (used by WAP):  


Review the options above for accuracy.  If they look okay,
type 'make all' to compile the main program and CGIs.</pre
          >
        </code>
        <p>Selanjutnya, buat nagios dengan perintah berikut:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ make all</pre>
        </code>
        <p>Selanjutnya, buat pengguna dan grup Nagios dan tambahkan ke grup www-data dengan perintah berikut:</p>
        <code>
          <pre>
arif@server-nagios:~/nagios-4.4.6$ sudo make install-groups-users 
arif@server-nagios:~/nagios-4.4.6$ sudo usermod -a -G nagios www-data</pre
          >
        </code>
        <p>Selanjutnya, jalankan perintah berikut untuk menginstal binari Nagios, daemon dan mode perintah:</p>
        <code>
          <pre>
arif@server-nagios:~/nagios-4.4.6$ sudo make install 
arif@server-nagios:~/nagios-4.4.6$ sudo make install-daemoninit 
arif@server-nagios:~/nagios-4.4.6$ sudo make install-commandmode</pre
          >
        </code>
        <p>Selanjutnya, instal contoh konfigurasi skrip dan konfigurasi web Apache menggunakan perintah berikut:</p>
        <code>
          <pre>
arif@server-nagios:~/nagios-4.4.6$ sudo make install-config 
arif@server-nagios:~/nagios-4.4.6$ sudo make install-webconf</pre
          >
        </code>
        <p>Selanjutnya, aktifkan modul rewrite dan cgi dengan perintah berikut:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo a2enmod rewrite cgi</pre>
        </code>
        <p>Selanjutnya, restart layanan Apache untuk menerapkan perubahan:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo systemctl restart apache2</pre>
        </code>
        <p>Langkah 4: Buat Pengguna Admin Nagios</p>
        <p>Selanjutnya, Kita perlu membuat pengguna Nagios untuk mengakses antarmuka web Nagios. Kita dapat membuatnya dengan perintah berikut:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo htpasswd -c /usr/local/nagios/etc/htpasswd.users nagiosadmin</pre>
        </code>
        <p>Kita akan diminta untuk mengatur kata sandi seperti yang ditunjukkan di bawah ini:</p>
        <code>
          <pre>
New password: 
Re-type new password: 
Adding password for user arifadmin</pre
          >
        </code>
        <p>Langkah 5: Konfigurasikan Nagios</p>
        <p>Sebelum mengonfigurasi Nagios, Kita harus menginstal Plugin Nagios dan Plugin NRPE. Kita dapat menginstalnya dengan perintah berikut:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo apt-get install monitoring-plugins nagios-nrpe-plugin -y</pre>
        </code>
        <p>Setelah semua paket diinstal, buat direktori untuk menyimpan semua konfigurasi:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo mkdir -p /usr/local/nagios/etc/servers</pre>
        </code>
        <p>Selanjutnya, edit file konfigurasi Nagios dan tentukan direktori server:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo vim /usr/local/nagios/etc/nagios.cfg </pre>
        </code>
        <p>Buang Pagar nya #</p>
        <p>Ubah baris berikut:</p>
        <code>
          <pre>cfg_dir=/usr/local/nagios/etc/servers</pre>
        </code>
        <p>Selanjutnya, edit Nagios resource.cfg dan tentukan jalur plugin Nagios:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo vim /usr/local/nagios/etc/resource.cfg </pre>
        </code>
        <p>Yang ini kasih pagar -> #$USER1$=/usr/local/nagios/libexec</p>
        <p>Ubah baris berikut:</p>
        <code>
          <pre>$USER1$=/usr/lib/nagios/plugins</pre>
        </code>
        <p>Simpan dan tutup file kemudian edit contacts.cfg dan tentukan nama kontak dan alamat email Anda:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo vim /usr/local/nagios/etc/objects/contacts.cfg </pre>
        </code>
        <p>Ubah baris berikut sesuai kebutuhan Anda:</p>
        <code>
          <pre>
define contact {

contact_name            nagiosadmin             ; Short name of user
use                     generic-contact         ; Inherit default values from generic-contact template (defined above)
alias                   Nagios Admin            ; Full name of user
email                   marifrizki27@gmail.com ; <<***** CHANGE THIS TO YOUR EMAIL ADDRESS ******
}</pre
          >
        </code>
        <p>Simpan dan tutup file kemudian edit command.cfg dan tentukan perintah nrpe check:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo vim /usr/local/nagios/etc/objects/commands.cfg</pre>
        </code>
        <p>Tambahkan baris berikut di akhir file:</p>
        <code>
          <pre>
define command{
command_name check_nrpe
command_line $USER1$/check_nrpe -H $HOSTADDRESS$ -c $ARG1$
}</pre
          >
        </code>
        <p>Simpan dan tutup file kemudian mulai layanan Nagios dan aktifkan untuk memulai saat reboot sistem:</p>
        <code>
          <pre>
arif@server-nagios:~/nagios-4.4.6$ sudo systemctl start nagios
arif@server-nagios:~/nagios-4.4.6$ sudo systemctl enable nagios</pre
          >
        </code>
        <p>Kita juga dapat memverifikasi status layanan Nagios dengan perintah berikut:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo systemctl status nagios</pre>
        </code>
        <p>Output</p>
        <code>
          <pre>
● nagios.service - Nagios Core 4.4.6
     Loaded: loaded (/lib/systemd/system/nagios.service; enabled; vendor preset: enabled)
     Active: active (running) since Sat 2022-03-26 22:21:00 UTC; 1min 12s ago
       Docs: https://www.nagios.org/documentation
    Process: 52032 ExecStartPre=/usr/local/nagios/bin/nagios -v /usr/local/nagios/etc/nagios.cfg (co>
    Process: 52038 ExecStart=/usr/local/nagios/bin/nagios -d /usr/local/nagios/etc/nagios.cfg (code=>
   Main PID: 52040 (nagios)
      Tasks: 6 (limit: 1073)
     Memory: 2.8M
     CGroup: /system.slice/nagios.service
             ├─52040 /usr/local/nagios/bin/nagios -d /usr/local/nagios/etc/nagios.cfg
             ├─52041 /usr/local/nagios/bin/nagios --worker /usr/local/nagios/var/rw/nagios.qh
             ├─52042 /usr/local/nagios/bin/nagios --worker /usr/local/nagios/var/rw/nagios.qh
             ├─52043 /usr/local/nagios/bin/nagios --worker /usr/local/nagios/var/rw/nagios.qh
             ├─52044 /usr/local/nagios/bin/nagios --worker /usr/local/nagios/var/rw/nagios.qh
             └─52048 /usr/local/nagios/bin/nagios -d /usr/local/nagios/etc/nagios.cfg

Mar 26 22:21:00 server-nagios nagios[52040]: qh: Socket '/usr/local/nagios/var/rw/nagios.qh' success>
Mar 26 22:21:00 server-nagios nagios[52040]: qh: core query handler registered
Mar 26 22:21:00 server-nagios nagios[52040]: qh: echo service query handler registered
Mar 26 22:21:00 server-nagios nagios[52040]: qh: help for the query handler registered
Mar 26 22:21:00 server-nagios nagios[52040]: wproc: Successfully registered manager as @wproc with q>
Mar 26 22:21:00 server-nagios nagios[52040]: wproc: Registry request: name=Core Worker 52041;pid=520>
Mar 26 22:21:00 server-nagios nagios[52040]: wproc: Registry request: name=Core Worker 52042;pid=520>
Mar 26 22:21:00 server-nagios nagios[52040]: wproc: Registry request: name=Core Worker 52044;pid=520>
Mar 26 22:21:00 server-nagios nagios[52040]: wproc: Registry request: name=Core Worker 52043;pid=520>
Mar 26 22:21:02 server-nagios nagios[52040]: Successfully launched command file worker with pid 52048
          </pre>
        </code>
        <p>Terakhir, restart layanan Apache untuk menerapkan perubahan:</p>
        <code>
          <pre>arif@server-nagios:~/nagios-4.4.6$ sudo systemctl restart apache2</pre>
        </code>
        <p>Langkah 6: Akses UI Web Nagios</p>
        <p>Sekarang, buka browser web Kita dan akses antarmuka web Nagios menggunakan URL http://nagios-server-ip/nagios/. Anda akan diminta untuk memberikan username dan password admin seperti yang ditunjukkan di bawah ini:</p>
        <img src="img/1.png" alt="login" width="1000" class="rounded-circle img-thumbnail" />
        <p>Berikan nama pengguna, kata sandi, dan kata sandi admin Nagios Kita dan klik tombol Masuk.</p>
        <p>Kita akan melihat dasbor Nagios di halaman berikut:</p>
        <img src="img/2.png" alt="tampilan nagios" width="1000" class="rounded-circle img-thumbnail" />
        <p>Klik pada service di panel kiri, Kita akan melihat semua layanan di halaman berikut:</p>
        <img src="img/3.png" alt="tampilan nagios" width="1000" class="rounded-circle img-thumbnail" />
        <p>Langkah 7: Tambahkan Host Pemantauan ke Server Nagios</p>
        <p>Selanjutnya, Kita perlu menginstal agen Nagios pada sistem klien dan menambahkannya ke server Nagios.</p>
        <p>Pertama, instal paket Nagios dan NRPE pada sistem klien dengan perintah berikut:</p>
        <p>Masuk Ke server Joomla</p>
        <code>
          <pre>arif@Testing:~$ ssh arif@192.168.100.88</pre>
          <pre>arif@server-joomla:~$ sudo apt-get update</pre>
          <pre>arif@server-joomla:~$ sudo apt-get install nagios-nrpe-server monitoring-plugins -y</pre>
        </code>
        <p>Setelah terinstal, edit file nrpe.cfg dan tentukan IP server Nagios dan IP CLient Anda:</p>
        <code>
          <pre>arif@server-joomla:~$ sudo vim /etc/nagios/nrpe.cfg</pre>
        </code>
        <p>Ubah baris berikut yang cocok dengan IP server dan klien Anda:</p>
        <p>192.168.100.88 itu IP Client Joomla</p>
        <p>192.168.100.118 itu IP Server Nagios:</p>
        <code>
          <pre>
server_address=192.168.100.88
allowed_hosts=127.0.0.1,::1,192.168.100.118</pre
          >
        </code>
        <p>Simpan dan tutup file. Kemudian edit nrpe_local.cfg:</p>
        <code>
          <pre>arif@server-joomla:~$ sudo vim /etc/nagios/nrpe_local.cfg</pre>
        </code>
        <p>Tambahkan atau ubah baris berikut:</p>
        <code>
          <pre>
command[check_root]=/usr/lib/nagios/plugins/check_disk -w 20% -c 10% -p /
command[check_ping]=/usr/lib/nagios/plugins/check_ping -H 192.168.100.88 -w 100.0,20% -c 500.0,60% -p 5
command[check_http]=/usr/lib/nagios/plugins/check_http -I 192.168.100.88
command[check_ssh]=/usr/lib/nagios/plugins/check_ssh -4 192.168.100.88</pre
          >
        </code>
        <p>Simpan dan tutup file kemudian restart layanan Nagios NRPE dan aktifkan untuk memulai saat reboot sistem:</p>
        <code>
          <pre>
arif@server-joomla:~$ sudo systemctl restart nagios-nrpe-server.service 
arif@server-joomla:~$ sudo systemctl enable nagios-nrpe-server.service </pre
          >
        </code>
        <p>Kita dapat memeriksa status layanan dengan perintah berikut:</p>
        <code>
          <pre>arif@server-joomla:~$ sudo systemctl status nagios-nrpe-server.service</pre>
        </code>
        <p>Output</p>
        <code>
          <pre>
● nagios-nrpe-server.service - Nagios Remote Plugin Executor
     Loaded: loaded (/lib/systemd/system/nagios-nrpe-server.service; enabled; vendor preset: enabled)
     Active: active (running) since Sat 2022-03-26 23:41:57 UTC; 56s ago
       Docs: http://www.nagios.org/documentation
   Main PID: 28782 (nrpe)
      Tasks: 1 (limit: 1071)
     Memory: 744.0K
     CGroup: /system.slice/nagios-nrpe-server.service
             └─28782 /usr/sbin/nrpe -c /etc/nagios/nrpe.cfg -f

Mar 26 23:41:57 server-joomla systemd[1]: Started Nagios Remote Plugin Executor.
Mar 26 23:41:57 server-joomla nrpe[28782]: Starting up daemon
Mar 26 23:41:57 server-joomla nrpe[28782]: Server listening on 192.168.100.88 port 5666.
Mar 26 23:41:57 server-joomla nrpe[28782]: Listening for connections on port 5666
Mar 26 23:41:57 server-joomla nrpe[28782]: Allowing connections from: 127.0.0.1,::1,192.168.100.118</pre
          >
        </code>
        <p>Langkah 8: Tambahkan Host Klien ke Server Nagios</p>
        <p>Selanjutnya, Kita perlu menambahkan host klien ke server Nagios dan menentukan layanan yang ingin Kita pantau.</p>
        <p>Di server Nagios, buat file baru bernama nagiosclient.cfg:</p>
        <p>Di Server NaGIOS</p>
        <code>
          <pre>arif@server-nagios:/usr/local/nagios/etc$ sudo vim /usr/local/nagios/etc/servers/nagiosclient.cfg</pre>
          <pre>
define host {
      use                          linux-server
      host_name                    nagiosclient
      alias                        Ubuntu Host
      address                      192.168.100.88
      register                     1
}

define service {
      host_name                       nagiosclient
      service_description             PING
      check_command                   check_nrpe!check_ping
      max_check_attempts              2
      check_interval                  2
      retry_interval                  2
      check_period                    24x7
      check_freshness                 1
      contact_groups                  admins
      notification_interval           2
      notification_period             24x7
      notifications_enabled           1
      register                        1
}

define service {
      host_name                       nagiosclient
      service_description             Check Users
      check_command                   check_nrpe!check_users
      max_check_attempts              2
      check_interval                  2
      retry_interval                  2
      check_period                    24x7
      check_freshness                 1
      contact_groups                  admins
      notification_interval           2
      notification_period             24x7
      notifications_enabled           1
      register                        1
}

define service {
      host_name                       nagiosclient
      service_description             Check SSH
      check_command                   check_nrpe!check_ssh
      max_check_attempts              2
      check_interval                  2
      retry_interval                  2
      check_period                    24x7
      check_freshness                 1
      contact_groups                  admins
      notification_interval           2
      notification_period             24x7
      notifications_enabled           1
      register                        1
}

define service {
      host_name                       nagiosclient
      service_description             Check Root / Disk
      check_command                   check_nrpe!check_root
      max_check_attempts              2
      check_interval                  2
      retry_interval                  2
      check_period                    24x7
      check_freshness                 1
      contact_groups                  admins
      notification_interval           2
      notification_period             24x7
      notifications_enabled           1
      register                        1
}

define service {
      host_name                       nagiosclient
      service_description             Check HTTP
      check_command                   check_nrpe!check_http
      max_check_attempts              2
      check_interval                  2
      retry_interval                  2
      check_period                    24x7
      check_freshness                 1
      contact_groups                  admins
      notification_interval           2
      notification_period             24x7
      notifications_enabled           1
      register                        1
}
    </pre
          >
        </code>
        <p>Simpan dan tutup file kemudian restart layanan Nagios untuk menerapkan perubahan:</p>
        <code>
          <pre>
arif@server-nagios:/usr/local/nagios/etc$ sudo systemctl restart nagios
arif@server-nagios:/usr/local/nagios/etc$ sudo systemctl status nagios</pre
          >
        </code>
        <p>Langkah 9: Verifikasi Nagios</p>
        <p>Sekarang, kembali ke antarmuka web Nagios dan klik hosts di panel kiri, Kita akan melihat semua host klien yang baru ditambahkan di halaman berikut:</p>
        <img src="img/4.png" alt="tampilan nagios" width="1000" class="rounded-circle img-thumbnail" />
        <p>Sekarang, klik pada tab service di panel kiri, Kita akan melihat semua layanan di halaman berikut:</p>
        <img src="img/5.png" alt="tampilan nagios" width="1000" class="rounded-circle img-thumbnail" />
      </section>

      <section class="main-section" id="Open_VPN_IPv4">
        <header>Open VPN IPv4</header>
        <p>
          OpenVPN is a virtual private network (VPN) system that implements techniques to create secure point-to-point or site-to-site connections in routed or bridged configurations and remote access facilities. It implements both client
          and server applications.
        </p>
        <p>
          OpenVPN allows peers to authenticate each other using pre-shared secret keys, certificates or username/password. When used in a multiclient-server configuration, it allows the server to release an authentication certificate for
          every client, using signatures and certificate authority.
        </p>
        <p>
          It uses the OpenSSL encryption library extensively, as well as the TLS protocol, and contains many security and control features. It uses a custom security protocol[11] that utilizes SSL/TLS for key exchange. It is capable of
          traversing network address translators (NATs) and firewalls.
        </p>
        <p>OpenVPN has been ported and embedded to several systems. For example, DD-WRT has the OpenVPN server function. SoftEther VPN, a multi-protocol VPN server, also has an implementation of OpenVPN protocol.</p>
        <p>It was written by James Yonan and is free software, released under the terms of the GNU General Public License version 2 (GPLv2). [12] Additionally, commercial licenses are available.</p>

        <header>Install Open VPN Dan Menggunakan</header>
        <p>OpenVPN Instalasi di Ubuntu 20.04.</p>
        <p>INSTALL OPENVPN DI SERVER</p>
        <p>YANG BAGUS BUAT VPN ITU PAKE (IPSEC DAN OPENVPN) JANGAN PAKE PPTP DAN I2TP KARENA PAKE USERNAME DAN PASSWORD GA PAKE ENKRIPSI</p>

        <p>Step 1 Update system</p>
        <code>
          <pre>
root@server:/home/arif# sudo apt update
root@server:/home/arif# sudo apt upgrade</pre
          >
        </code>

        <p>Step 2 – Cek IP address</p>
        <code>
          <pre>
root@server:/home/arif# ip a
root@server:/home/arif# ip link
root@server:/home/arif# ifconfig wlx1cbfce9982b7 172.16.100.12 netmask 255.255.255.0</pre
          >
        </code>

        <p>Step 3 – Download & run openvpn-install.sh script</p>
        <p>Pastikan tidak ada yang menggunakan repository ubuntu</p>
        <code>
          <pre>root@server:/home/arifsudo rm -Rf /var/lib/dpkg/lock</pre>
        </code>

        <p>Download Open VPN</p>
        <code>
          <pre>
root@server:/home/arif# chmod 644 /usr/local/src/
root@server:/home/arif# cd /usr/local/src/
root@server:/usr/local/src# wget https://git.io/vpn -O openvpn-install.sh
root@server:/usr/local/src# chmod +x openvpn-install.sh</pre
          >
        </code>

        <p>Jalankan</p>
        <code>
          <pre>root@server:/usr/local/src# sudo ./openvpn-install.sh</pre>
        </code>
        <code>
          <pre>
Welcome to this OpenVPN road warrior installer!
Which IPv4 address should be used?
1) 192.168.100.21
2) 172.16.100.12
IPv4 address [1]: 1</pre
          >
        </code>

        <code>
          <pre>
This server is behind NAT. What is the public IPv4 address or hostname?
Public IPv4 address / hostname [180.254.68.214]: 192.168.100.21
Which protocol should OpenVPN use?
      1) UDP (recommended)
      2) TCP
      Protocol [1]: 1</pre
          >
        </code>
        <code>
          <pre>
What port should OpenVPN listen to?
Port [1194]: 2500

Select a DNS server for the clients:
      1) Current system resolvers
      2) Google
      3) 1.1.1.1 # <- YANG INI JUGA OKE
      4) OpenDNS
      5) Quad9
      6) AdGuard
DNS server [1]: 1
Enter a name for the first client:
Name [client]: yoai-testing
Press any key to continue...
ENTER</pre
          >
        </code>

        <p>Check</p>
        <code>
          <pre>
root@server:/usr/local/src# cd /root/
root@server:~# mv yoai-testing.ovpn /home/arif/</pre
          >
        </code>

        <p>COBA JGN GANTI USER KALO GA BISA PAKE DI BAWAH INI</p>
        <code>
          <pre>root@server:~# chown arif: /home/arif/yoai-testing.ovpn # <- JGN PAKE INI</pre>
        </code>

        <p>Step 4 – Connect an OpenVPN server using IOS/Android/Linux/Windows client</p>
        <p>Copykan file sertifikat client.ovpn ke client, misalnya menggunakan perintah,</p>
        <code>
          <pre>
root@parrot:~# scp -P3000 arif@192.168.100.21:*ovpn .
root@parrot:~# sudo openvpn --config yoai-testing.ovpn</pre
          >
        </code>

        <p>Linux Desktop: OpenVPN client configuration</p>
        <p>Install</p>
        <code>
          <pre>root@parrot:~# sudo apt -y install openvpn</pre>
        </code>

        <p>Jalankan</p>
        <p>KALO ngga PAKE INI BISA</p>
        <code>
          <pre>root@parrot:~# sudo --client --config yoai-testing.ovpn</pre>
        </code>

        <p>Step 5 - Verify/test the connectivity</p>
        <code>
          <pre>
Execute the following commands after connecting to OpenVPN server from your Linux desktop:
ping 10.8.0.1       # Ping to the OpenVPN server gateway
ip route            # Make sure routing setup working
dig TXT +short o-o.myaddr.l.google.com @ns1.google.com #Must return public IP address of OpenVPN server</pre
          >
        </code>

        <p>Beberapa catatan troubleshooting OpenVPN & Client</p>
        <p>Cek OpenVPN server for errors:</p>
        <code>
          <pre>journalctl --identifier ovpn-server</pre>
        </code>

        <p>Cek Filewall Rules</p>
        <code>
          <pre>
cat /etc/rc.local
#!/bin/sh -e
iptables -t nat -A POSTROUTING -s 10.8.0.0/24 ! -d 10.8.0.0/24 -j SNAT --to 172.26.6.74
exit 0</pre
          >
        </code>

        <p>Alternatif lain, run iptables command & sysctl command untuk verifikasi NAT rule setup</p>
        <code>
          <pre>
sudo iptables -t nat -L -n -v
sysctl net.ipv4.ip_forward
Insert rules ke /etc/rc.local (kalau belum di insert)</pre
          >
        </code>

        <code>
          <pre>
sudo sh /etc/rc.local
sudo sysctl -w net.ipv4.ip_forward=1</pre
          >
        </code>
        <p>Is OpenVPN server running and port is open? Use the ss command or netstat command and pidof command/ps command:</p>

        <code>
          <pre>
$ netstat -tulpn | grep :1194 ## 1194 is the openvpn server port ##
$ ss -tulpn | grep :1194 ## 1194 is the openvpn server port ##
$ ps aux | grep openvpn ## is the openvpn server running? ##
$ ps -C openvpn ## is the openvpn server running? ##
$ pidof openvpn ## find the openvpn server PID ##</pre
          >
        </code>
        <p>Verify that OpenVPN server runnign and Port is Open on ubuntu Linux If not running, restart the OpenVPN server:</p>
        <code>
          <pre>
$ sudo systemctl restart openvpn@server
Look out for errors:
$ sudo systemctl status openvpn@server</pre
          >
        </code>
        <p>Can the Linux desktop client connect to the OpenVPN server machine? First you need to run a simple test to see if the</p>
        <p>OpenVPN server port (UDP 1194) accepts connections:</p>

        <code>
          <pre>
$ nc -vu 104.20.187.5 1194
Connection to 104.20.187.5 1194 port [udp/openvpn] succeeded!</pre
          >
        </code>
      </section>
    </main>
  </body>
</html>
